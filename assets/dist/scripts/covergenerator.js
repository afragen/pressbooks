!function(e){var n={};function r(o){if(n[o])return n[o].exports;var t=n[o]={i:o,l:!1,exports:{}};return e[o].call(t.exports,t,t.exports,r),t.l=!0,t.exports}r.m=e,r.c=n,r.d=function(e,n,o){r.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:o})},r.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(n,"a",n),n},r.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},r.p="/",r(r.s=4)}({4:function(e,n,r){e.exports=r("4hi5")},"4hi5":function(e,n){jQuery(function(e){e(document).ready(function(){var n=void 0;e(".front-background-image-upload-button").click(function(r){r.preventDefault(),n||(n=wp.media.frames.file_frame=wp.media({multiple:!1})).on("select",function(){var r=n.state().get("selection").first().toJSON();e("#front_background_image").val(r.url),e(".front-background-image").attr("src",r.url),e(".front-background-image-preview-wrap").removeClass("hidden"),e(".front-background-image-upload-button, .front-background-image-description").addClass("hidden")}),n.open()})}),e(".delete-front-background-image").on("click",function(){e("#front_background_image").val(""),e(".front-background-image-preview-wrap").addClass("hidden"),e(".front-background-image-upload-button, .front-background-image-description").removeClass("hidden")});var n=e("#ppi"),r=e("#custom_ppi");""!==n.val()&&r.parent().parent().hide(),n.on("change",function(){""===e(this).val()?r.parent().parent().show():(r.parent().parent().hide(),r.val(e(this).val()))}),e(".colorpicker").wpColorPicker();var o=e("#pb-sse-progressbar"),t=e("#pb-sse-info"),a=e("#generate-pdf"),i=e("#generate-jpg"),u=null,c=e("#pb-sse-seconds"),l=e("#pb-sse-minutes");function s(e){return e>9?e:"0"+e}e(".settings-form").on("saveAndGenerate",function(n,r){var d;return a.hide(),i.hide(),d=0,c.html("00"),l.html("00:"),u=setInterval(function(){c.html(s(++d%60)),l.html(s(parseInt(d/60,10))+":")},1e3),o.progressbar({value:10}),t.html(PB_CoverGeneratorToken.ajaxSubmitMsg),e(this).ajaxSubmit({done:function(n){var r=e("form."+n),a=PB_CoverGeneratorToken.ajaxUrl+(PB_CoverGeneratorToken.ajaxUrl.includes("?")?"&":"?")+e.param(r.find(":input")),i=new EventSource(a);i.onopen=function(){e(window).on("beforeunload",function(){return PB_CoverGeneratorToken.unloadWarning})},i.onmessage=function(n){var r=JSON.parse(n.data);switch(r.action){case"updateStatusBar":o.progressbar({value:parseInt(r.percentage,10)}),t.html(r.info);break;case"complete":i.close(),e(window).unbind("beforeunload"),r.error?(o.progressbar({value:!1}),t.html(r.error+" "+PB_CoverGeneratorToken.reloadSnippet),u&&clearInterval(u)):window.location=PB_CoverGeneratorToken.redirectUrl}},i.onerror=function(){i.close(),o.progressbar({value:!1}),t.html("EventStream Connection Error "+PB_CoverGeneratorToken.reloadSnippet),e(window).unbind("beforeunload"),u&&clearInterval(u)}}(r),timeout:5e3}),!1}),a.click(function(){var n=tinymce.get("pb_about_unlimited");if(n){var r=n.getContent();e("#pb_about_unlimited").val(r)}e("form.settings-form").trigger("saveAndGenerate",["pdf"])}),i.click(function(){e("form.settings-form").trigger("saveAndGenerate",["jpg"])})})}});